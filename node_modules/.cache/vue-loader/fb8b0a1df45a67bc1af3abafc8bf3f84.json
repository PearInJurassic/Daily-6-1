{"remainingRequest":"C:\\Users\\Macbook Pro\\Desktop\\新建文件夹 (2)\\Daily-6-1\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Macbook Pro\\Desktop\\新建文件夹 (2)\\Daily-6-1\\src\\pages\\PostPage\\components\\Panel\\PanelPostEdit.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Macbook Pro\\Desktop\\新建文件夹 (2)\\Daily-6-1\\src\\pages\\PostPage\\components\\Panel\\PanelPostEdit.vue","mtime":1590508887522},{"path":"C:\\Users\\Macbook Pro\\Desktop\\新建文件夹 (2)\\Daily-6-1\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1590508866028},{"path":"C:\\Users\\Macbook Pro\\Desktop\\新建文件夹 (2)\\Daily-6-1\\node_modules\\babel-loader\\lib\\index.js","mtime":1590508865567},{"path":"C:\\Users\\Macbook Pro\\Desktop\\新建文件夹 (2)\\Daily-6-1\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1590508866028},{"path":"C:\\Users\\Macbook Pro\\Desktop\\新建文件夹 (2)\\Daily-6-1\\node_modules\\vue-loader\\lib\\index.js","mtime":1590508885674}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBCdXMgZnJvbSAiQC9KUy9idXMuanMiCmltcG9ydCBMaW5lV29yZExpbmUgZnJvbSAiQC9jb21wb25lbnRzL0xpbmVXb3JkTGluZSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlBvc3RQYW5lbCIsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlzU2hvdzogdHJ1ZSwKICAgICAgdGFnczogJycsCiAgICAgIHBvc3RUZXh0OiAnJywKICAgICAgZGlhbG9nSW1hZ2VVcmw6ICcnLAogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgc2hvd01vZGFsOiBmYWxzZSwKICAgICAgZG9tYWluOiAnaHR0cHM6Ly91cGxvYWQucWluaXVwLmNvbScsCiAgICAgIHFpbml1YWRkcjogJ2h0dHA6Ly9xOXN0bHE4N3EuYmt0LmNsb3VkZG4uY29tJywKICAgICAgcG9zdERhdGE6IHsKICAgICAgICBrZXk6ICcnLAogICAgICAgIHRva2VuOiAnJwogICAgICB9LAogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgLyoqCiAgICAgKiBAZGVzY3JpcHRpb24g5Yid5aeL5YyW77yM6I635Y+W5LiD54mbdG9rZW4KICAgICAqLwogICAgaW5pdCgpIHsKICAgICAgdGhpcy51c2VySWQgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdJRCcpOwogICAgICB0aGlzLmF4aW9zLmdldCgnaHR0cDovL3p6emlhLm5ldDo4MDgwL3Fpbml1LycsIHsKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIGFjY2Vzc0tleTogIlJ3QzR1STVqYkNmRTNJVXVva0VQN3BhWE9RUUExNG1jRDg3TVE2bWwiLAogICAgICAgICAgc2VjcmV0S2V5OiAibzZjUG1vN1ItUVVXNDExM2sxTU5OaU5qV0hPeXpuai1GRVJ5UF94YSIsCiAgICAgICAgICBidWNrZXQ6ICJkYWlseWRhdGEiCiAgICAgICAgfQogICAgICB9KS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgIHRoaXMucG9zdERhdGEudG9rZW4gPSByZXNwb25zZS5kYXRhLnRva2VuCiAgICAgICAgLy8gdGhpcy5wb3N0RGF0YS5rZXkgPSByZXNwb25zZS5kYXRhLmtleQogICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3BvbnNlKQogICAgICB9KQogICAgfSwKICAgIC8qKgogICAgICogQGRlc2NyaXB0aW9uIOS9v+eUqOS6i+S7tuaAu+e6v+WPkemAgeWujOaIkOe8lui+keS/oeWPtyDnlLFDb250ZW50UG9zdE1haW7lpITnkIYKICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmbGFnIOWujOaIkOS/oeWPtyzlj6/og73mnIkiZmluaXNoIuato+W4uOe7k+adn++8jOWSjOKAnGNsb3NlIuebtOaOpeWFs+mXreOAggogICAgICovCiAgICBmaW5pc2hFZGl0KGZsYWcpIHsKICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICBsZXQgYW5vbnltID0gdGhpcy4kc3RvcmUuc3RhdGUuaXNBbm9ueW1vdXM7CiAgICAgIHRoaXMuYXhpb3MucG9zdChgJHt0aGlzLkdMT0JBTC5hcGlVcmx9L2FkZHBvc3RgLCB7CiAgICAgICAgcG9zdEltZzogdGhhdC5kaWFsb2dJbWFnZVVybCwKICAgICAgICBwb3N0Q29udGVudDogdGhhdC5wb3N0VGV4dCwKICAgICAgICBhbm9ueW0sCiAgICAgICAgYXJlYUlkOiAwLAogICAgICAgIHVzZXJJZDogc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnSUQnKSwKICAgICAgICBmb3J3YXJkUG9zdElkOiAtMSwKICAgICAgfSkKICAgICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgICB0aGlzLnBvc3RUZXh0PScnOwogICAgICAgICAgdGhpcy5kaWFsb2dJbWFnZVVybD0nJzsKICAgICAgICAgIHRoaXMuJHJlZnMucGljdHVyZVVwbG9hZGVyLmNsZWFyRmlsZXMoKTsKICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZGlhbG9nSW1hZ2VVcmwpCiAgICAgICAgICBCdXMuJGVtaXQoImZpbmlzaEVkaXQiLCBmbGFnKTsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHJlc3BvbnNlKQogICAgICAgIH0pCiAgICB9LAogICAgYmVmb3JlSW1nVXBsb2FkKGZpbGUpIHsKICAgICAgdGhpcy5wb3N0RGF0YS5rZXk9YHVwbG9hZF9waWNfJHtmaWxlLm5hbWV9YDsKICAgIH0sCiAgICBoYW5kbGVSZW1vdmUoZmlsZSwgZmlsZUxpc3QpIHsKICAgICAgY29uc29sZS5sb2coZmlsZSwgZmlsZUxpc3QpOwogICAgfSwKICAgIGhhbmRsZVBpY3R1cmVDYXJkUHJldmlldyhmaWxlKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKGZpbGUpCiAgICAgIHRoaXMuZGlhbG9nSW1hZ2VVcmwgPSBmaWxlLnVybDsKICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZTsKICAgIH0sCiAgICBoYW5kbGVQaWN0dXJlU3VjY2VzcyhyZXMpIHsKICAgICAgdGhpcy5kaWFsb2dJbWFnZVVybCA9IGAke3RoaXMucWluaXVhZGRyfS8ke3Jlcy5rZXl9YAogICAgICBjb25zb2xlLmxvZyh0aGlzLmRpYWxvZ0ltYWdlVXJsKQogICAgfQogIH0sCiAgY29tcG9uZW50czogewogICAgTGluZVdvcmRMaW5lCiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5pbml0KCkKICB9Cn0K"},{"version":3,"sources":["PanelPostEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PanelPostEdit.vue","sourceRoot":"src/pages/PostPage/components/Panel","sourcesContent":["<template>\r\n    <div class=\"Panel\" v-if=\"isShow\">\r\n        <div @click=\"finishEdit(`close`)\"\r\n             class=\"Mask\"></div>\r\n        <div class=\"EditPanel\">\r\n            <div class=\"PicturePanel\">\r\n                <el-upload\r\n                        ref=\"pictureUploader\"\r\n                        :action=\"domain\"\r\n                        :data=\"postData\"\r\n                        :on-preview=\"handlePictureCardPreview\"\r\n                        :on-remove=\"handleRemove\"\r\n                        :on-success=\"handlePictureSuccess\"\r\n                        :before-upload=\"beforeImgUpload\"\r\n                        list-type=\"picture-card\">\r\n                    <i class=\"el-icon-plus\"></i>\r\n                </el-upload>\r\n                <el-dialog :modal=\"showModal\" :visible.sync=\"dialogVisible\">\r\n                    <el-image :src=\"dialogImageUrl\" alt=\"\" width=\"100%\"></el-image>\r\n                </el-dialog>\r\n            </div>\r\n            <div class=\"TextPanel\">\r\n                <div class=\"logo\">\r\n                    <img src=\"@/assets/NavBar/logo.png\">\r\n                </div>\r\n                <LineWordLine>编辑</LineWordLine>\r\n                <el-form>\r\n                    <el-form-item label=\"文本内容：\">\r\n                        <el-input\r\n                                :row=\"5\"\r\n                                placehoder=\"请输入内容\"\r\n                                type=\"textarea\"\r\n                                v-model=\"postText\">\r\n                        </el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"Tags（请以空格分隔）\">\r\n                        <el-input :disabled=\"true\" v-model=\"tags\"></el-input>\r\n                    </el-form-item>\r\n                    <input @click=\"finishEdit(`finish`)\" class=\"CommonButton\" id=\"TextEditButton\" type=\"button\"\r\n                           value=\"完成\">\r\n                </el-form>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n  import Bus from \"@/JS/bus.js\"\r\n  import LineWordLine from \"@/components/LineWordLine\";\r\n\r\n  export default {\r\n    name: \"PostPanel\",\r\n    data() {\r\n      return {\r\n        isShow: true,\r\n        tags: '',\r\n        postText: '',\r\n        dialogImageUrl: '',\r\n        dialogVisible: false,\r\n        showModal: false,\r\n        domain: 'https://upload.qiniup.com',\r\n        qiniuaddr: 'http://q9stlq87q.bkt.clouddn.com',\r\n        postData: {\r\n          key: '',\r\n          token: ''\r\n        },\r\n      }\r\n    },\r\n    methods: {\r\n      /**\r\n       * @description 初始化，获取七牛token\r\n       */\r\n      init() {\r\n        this.userId = sessionStorage.getItem('ID');\r\n        this.axios.get('http://zzzia.net:8080/qiniu/', {\r\n          params: {\r\n            accessKey: \"RwC4uI5jbCfE3IUuokEP7paXOQQA14mcD87MQ6ml\",\r\n            secretKey: \"o6cPmo7R-QUW4113k1MNNiNjWHOyznj-FERyP_xa\",\r\n            bucket: \"dailydata\"\r\n          }\r\n        }).then((response) => {\r\n          this.postData.token = response.data.token\r\n          // this.postData.key = response.data.key\r\n          // console.log(response)\r\n        })\r\n      },\r\n      /**\r\n       * @description 使用事件总线发送完成编辑信号 由ContentPostMain处理\r\n       * @param {string} flag 完成信号,可能有\"finish\"正常结束，和“close\"直接关闭。\r\n       */\r\n      finishEdit(flag) {\r\n        let that = this;\r\n        let anonym = this.$store.state.isAnonymous;\r\n        this.axios.post(`${this.GLOBAL.apiUrl}/addpost`, {\r\n          postImg: that.dialogImageUrl,\r\n          postContent: that.postText,\r\n          anonym,\r\n          areaId: 0,\r\n          userId: sessionStorage.getItem('ID'),\r\n          forwardPostId: -1,\r\n        })\r\n          .then(() => {\r\n            this.postText='';\r\n            this.dialogImageUrl='';\r\n            this.$refs.pictureUploader.clearFiles();\r\n            console.log(this.dialogImageUrl)\r\n            Bus.$emit(\"finishEdit\", flag);\r\n            // console.log(response)\r\n          })\r\n      },\r\n      beforeImgUpload(file) {\r\n        this.postData.key=`upload_pic_${file.name}`;\r\n      },\r\n      handleRemove(file, fileList) {\r\n        console.log(file, fileList);\r\n      },\r\n      handlePictureCardPreview(file) {\r\n        // console.log(file)\r\n        this.dialogImageUrl = file.url;\r\n        this.dialogVisible = true;\r\n      },\r\n      handlePictureSuccess(res) {\r\n        this.dialogImageUrl = `${this.qiniuaddr}/${res.key}`\r\n        console.log(this.dialogImageUrl)\r\n      }\r\n    },\r\n    components: {\r\n      LineWordLine\r\n    },\r\n    created() {\r\n      this.init()\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n    @import \"~@/CSS/Common.less\";\r\n\r\n    .EditPanel {\r\n        background-color: whitesmoke;\r\n        .setMinSize(850px, 500px);\r\n        .setBorder(0px);\r\n        border-radius: 2px;\r\n        box-shadow: 0 0 3px #2c2d2c;\r\n        position: fixed;\r\n        top: calc(50% - 250px);\r\n        left: calc(50% - 425px);\r\n        z-index: 15;\r\n        display: flex;\r\n    }\r\n\r\n    .PicturePanel {\r\n        .setSize(468px, 500px);\r\n        border-right: 1px solid black;\r\n        display: flex;\r\n        flex-wrap: wrap;\r\n        padding-left: 10px;\r\n        padding-top: 15px;\r\n    }\r\n\r\n    .logo {\r\n        display: flex;\r\n        justify-content: center;\r\n    }\r\n\r\n    .TextPanel {\r\n        width: 350px;\r\n        display: flex;\r\n        flex-direction: column;\r\n        padding: 0 9px;\r\n        justify-content: center;\r\n\r\n        label {\r\n            margin: 5px auto;\r\n        }\r\n    }\r\n</style>"]}]}