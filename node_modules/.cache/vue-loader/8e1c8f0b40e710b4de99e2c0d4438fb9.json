{"remainingRequest":"C:\\Users\\linjie\\Desktop\\分享\\Daily-6-1\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\linjie\\Desktop\\分享\\Daily-6-1\\src\\pages\\PostPage\\components\\Panel\\PanelPersonInfoEdit.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\linjie\\Desktop\\分享\\Daily-6-1\\src\\pages\\PostPage\\components\\Panel\\PanelPersonInfoEdit.vue","mtime":1590322633695},{"path":"C:\\Users\\linjie\\Desktop\\分享\\Daily-6-1\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1590322393809},{"path":"C:\\Users\\linjie\\Desktop\\分享\\Daily-6-1\\node_modules\\babel-loader\\lib\\index.js","mtime":1590322384777},{"path":"C:\\Users\\linjie\\Desktop\\分享\\Daily-6-1\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1590322393809},{"path":"C:\\Users\\linjie\\Desktop\\分享\\Daily-6-1\\node_modules\\vue-loader\\lib\\index.js","mtime":1590322614216}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBMaW5lV29yZExpbmUgZnJvbSAiQC9jb21wb25lbnRzL0xpbmVXb3JkTGluZSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlBhbmVsUGVyc29uSW5mb0VkaXQiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB1c2VySWQ6IDEsCiAgICAgIGRvbWFpbjogJ2h0dHBzOi8vdXBsb2FkLnFpbml1cC5jb20nLAogICAgICBwb3N0RGF0YTp7CiAgICAgICAga2V5Om51bGwsCiAgICAgICAgdG9rZW46JycKICAgICAgfSwKICAgICAgcWluaXVhZGRyOiAnaHR0cDovL3E5c3RscTg3cS5ia3QuY2xvdWRkbi5jb20nLAogICAgICBpbWFnZVVybDogJycsCiAgICAgIG5pY2tOYW1lOiAnJywKICAgICAgcGVyc29uVGV4dDogJycsCiAgICAgIGdlbmRlclJhZGlvOiAn55S3JwogICAgfTsKICB9LAogIHByb3BzOiB7CiAgICB1c2VySW5mbzogewogICAgICByZXF1aXJlZDogdHJ1ZQogICAgfQogIH0sCiAgY29tcG9uZW50czogewogICAgTGluZVdvcmRMaW5lLAogIH0sCiAgbWV0aG9kczogewogICAgaW5pdCgpIHsKICAgICAgdGhpcy51c2VySWQgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdJRCcpOwogICAgICB0aGlzLmltYWdlVXJsID0gdGhpcy51c2VySW5mby51c2VySW1nCiAgICAgIHRoaXMubmlja05hbWUgPSB0aGlzLnVzZXJJbmZvLnVzZXJOaWNlTmFtZTsKICAgICAgdGhpcy5wZXJzb25UZXh0ID0gdGhpcy51c2VySW5mby53b3JkczsKICAgICAgdGhpcy5heGlvcy5nZXQoJ2h0dHA6Ly96enppYS5uZXQ6ODA4MC9xaW5pdS8nLHsKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIGFjY2Vzc0tleTogIlJ3QzR1STVqYkNmRTNJVXVva0VQN3BhWE9RUUExNG1jRDg3TVE2bWwiLAogICAgICAgICAgc2VjcmV0S2V5OiAibzZjUG1vN1ItUVVXNDExM2sxTU5OaU5qV0hPeXpuai1GRVJ5UF94YSIsCiAgICAgICAgICBidWNrZXQ6ICJkYWlseWRhdGEiCiAgICAgICAgfQogICAgICB9KS50aGVuKChyZXNwb25zZSkgPT57CiAgICAgICAgdGhpcy5wb3N0RGF0YS50b2tlbj1yZXNwb25zZS5kYXRhLnRva2VuCiAgICAgICAgLy8gdGhpcy5wb3N0RGF0YS5rZXkgPSByZXNwb25zZS5kYXRhLmtleQogICAgICAgIGNvbnNvbGUubG9nKHRoaXMucG9zdERhdGEpCiAgICAgIH0pCiAgICB9LAogICAgLyoqCiAgICAgKiBAZGVzY3JpcHRpb24g5o+Q5Lqk5Liq5Lq65L+h5oGv5L+u5pS5CiAgICAgKi8KICAgIGVkaXRJbmZvKCkgewogICAgICB0aGlzLmF4aW9zLnBvc3QoYCR7dGhpcy5HTE9CQUwuYXBpVXJsfS91cGRhdGVVc2VySW5mb2AsIHsKICAgICAgICB1c2VySWQ6IHRoaXMudXNlcklkLAogICAgICAgIHVzZXJOYW1lOiB0aGlzLm5pY2tOYW1lLAogICAgICAgIGdlbmRlcjogdGhpcy5nZW5kZXJSYWRpbywKICAgICAgICBwcm9maWxlOiB0aGlzLnBlcnNvblRleHQsCiAgICAgICAgdXNlckltZzp0aGlzLmltYWdlVXJsLAogICAgICB9KQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpCiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5zdWNjZXNzKSB7CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgIG1lc3NhZ2U6ICLkv67mlLnkuKrkurrkv6Hmga/miJDlip8iLAogICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICAgICAgICB9KQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgbWVzc2FnZTogIuWPkeeUn+S6huS4jeWPr+mihOefpeeahOmUmeivr++8jOivt+eojeWQjuWGjeivleivlSIsCiAgICAgICAgICAgICAgdHlwZTogIndhcm5pbmciCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLiRlbWl0KCdmaW5pc2hFZGl0SW5mbycpCiAgICAgICAgfSkKICAgIH0sCiAgICBoYW5kbGVBdmF0YXJTdWNjZXNzKHJlcykgewogICAgICAvLyB0aGlzLmltYWdlVXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlLnJhdyk7CiAgICAgIHRoaXMuaW1hZ2VVcmwgPSBgJHt0aGlzLnFpbml1YWRkcn0vJHtyZXMua2V5fWAKICAgICAgLy8gY29uc29sZS5sb2cocmVzKQogICAgICBjb25zb2xlLmxvZyh0aGlzLmltYWdlVXJsKQogICAgfSwKICAgIGJlZm9yZUF2YXRhclVwbG9hZChmaWxlKSB7CiAgICAgIGNvbnN0IGlzSlBHID0gZmlsZS50eXBlID09PSAnaW1hZ2UvanBlZyc7CiAgICAgIGNvbnN0IGlzTHQyTSA9IGZpbGUuc2l6ZSAvIDEwMjQgLyAxMDI0IDwgMjsKCiAgICAgIGlmICghaXNKUEcpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfkuIrkvKDlpLTlg4/lm77niYflj6rog73mmK8gSlBHIOagvOW8jyEnKTsKICAgICAgfQogICAgICBpZiAoIWlzTHQyTSkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+S4iuS8oOWktOWDj+WbvueJh+Wkp+Wwj+S4jeiDvei2hei/hyAyTUIhJyk7CiAgICAgIH0KICAgICAgdGhpcy5wb3N0RGF0YS5rZXkgPSBgdXBsb2FkX3BpY18ke2ZpbGUubmFtZX1gCiAgICAgIHJldHVybiBpc0pQRyAmJiBpc0x0Mk07CiAgICB9LAogICAgZXJyb3JIYW5kbGVyKGVycixmaWxlKXsKICAgICAgY29uc29sZS5sb2coZmlsZSkKICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmluaXQoKTsKICB9Cn0K"},{"version":3,"sources":["PanelPersonInfoEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PanelPersonInfoEdit.vue","sourceRoot":"src/pages/PostPage/components/Panel","sourcesContent":["<template>\r\n    <div style=\"width: 100%;display: flex;flex-direction: row;justify-content: space-between;\">\r\n        <div class=\"InformationPanel\">\r\n            <LineWordLine>上传头像</LineWordLine>\r\n            <div class=\"AvatarUploader\">\r\n                <el-upload\r\n                        class=\"avatar-uploader\"\r\n                        :action=\"domain\"\r\n                        :data=\"postData\"\r\n                        :show-file-list=\"false\"\r\n                        :on-success=\"handleAvatarSuccess\"\r\n                        :on-error=\"errorHandler\"\r\n                        :before-upload=\"beforeAvatarUpload\">\r\n                    <img v-if=\"imageUrl\" :src=\"imageUrl\" class=\"avatar\">\r\n                    <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n                </el-upload>\r\n            </div>\r\n            <LineWordLine>修改信息</LineWordLine>\r\n            <div>\r\n                <el-form>\r\n                    <el-form-item label=\"新的昵称\">\r\n                        <el-input v-model=\"nickName\"></el-input>\r\n                    </el-form-item>\r\n                </el-form>\r\n            </div>\r\n        </div>\r\n        <div class=\"InformationPanel\">\r\n            <LineWordLine>\r\n                其他信息\r\n            </LineWordLine>\r\n            <div>\r\n                <el-form>\r\n                    <el-form-item label=\"性别\">\r\n                        <el-radio label=\"男\" v-model=\"genderRadio\">男</el-radio>\r\n                        <el-radio label=\"女\" v-model=\"genderRadio\">女</el-radio>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"个性签名\">\r\n                        <el-input\r\n                                :row=\"3\"\r\n                                placehoder=\"请输入内容\"\r\n                                type=\"textarea\"\r\n                                v-model=\"personText\">\r\n                        </el-input>\r\n                    </el-form-item>\r\n                    <div>\r\n                        <button @click.prevent=\"editInfo\" class=\"CommonButton\">提交</button>\r\n                    </div>\r\n                </el-form>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n  import LineWordLine from \"@/components/LineWordLine\";\r\n\r\n  export default {\r\n    name: \"PanelPersonInfoEdit\",\r\n    data() {\r\n      return {\r\n        userId: 1,\r\n        domain: 'https://upload.qiniup.com',\r\n        postData:{\r\n          key:null,\r\n          token:''\r\n        },\r\n        qiniuaddr: 'http://q9stlq87q.bkt.clouddn.com',\r\n        imageUrl: '',\r\n        nickName: '',\r\n        personText: '',\r\n        genderRadio: '男'\r\n      };\r\n    },\r\n    props: {\r\n      userInfo: {\r\n        required: true\r\n      }\r\n    },\r\n    components: {\r\n      LineWordLine,\r\n    },\r\n    methods: {\r\n      init() {\r\n        this.userId = sessionStorage.getItem('ID');\r\n        this.imageUrl = this.userInfo.userImg\r\n        this.nickName = this.userInfo.userNiceName;\r\n        this.personText = this.userInfo.words;\r\n        this.axios.get('http://zzzia.net:8080/qiniu/',{\r\n          params: {\r\n            accessKey: \"RwC4uI5jbCfE3IUuokEP7paXOQQA14mcD87MQ6ml\",\r\n            secretKey: \"o6cPmo7R-QUW4113k1MNNiNjWHOyznj-FERyP_xa\",\r\n            bucket: \"dailydata\"\r\n          }\r\n        }).then((response) =>{\r\n          this.postData.token=response.data.token\r\n          // this.postData.key = response.data.key\r\n          console.log(this.postData)\r\n        })\r\n      },\r\n      /**\r\n       * @description 提交个人信息修改\r\n       */\r\n      editInfo() {\r\n        this.axios.post(`${this.GLOBAL.apiUrl}/updateUserInfo`, {\r\n          userId: this.userId,\r\n          userName: this.nickName,\r\n          gender: this.genderRadio,\r\n          profile: this.personText,\r\n          userImg:this.imageUrl,\r\n        })\r\n          .then((response) => {\r\n            console.log(response)\r\n            if (response.data.success) {\r\n              this.$message({\r\n                message: \"修改个人信息成功\",\r\n                type: 'success'\r\n              })\r\n            } else {\r\n              this.$message({\r\n                message: \"发生了不可预知的错误，请稍后再试试\",\r\n                type: \"warning\"\r\n              })\r\n            }\r\n            this.$emit('finishEditInfo')\r\n          })\r\n      },\r\n      handleAvatarSuccess(res) {\r\n        // this.imageUrl = URL.createObjectURL(file.raw);\r\n        this.imageUrl = `${this.qiniuaddr}/${res.key}`\r\n        // console.log(res)\r\n        console.log(this.imageUrl)\r\n      },\r\n      beforeAvatarUpload(file) {\r\n        const isJPG = file.type === 'image/jpeg';\r\n        const isLt2M = file.size / 1024 / 1024 < 2;\r\n\r\n        if (!isJPG) {\r\n          this.$message.error('上传头像图片只能是 JPG 格式!');\r\n        }\r\n        if (!isLt2M) {\r\n          this.$message.error('上传头像图片大小不能超过 2MB!');\r\n        }\r\n        this.postData.key = `upload_pic_${file.name}`\r\n        return isJPG && isLt2M;\r\n      },\r\n      errorHandler(err,file){\r\n        console.log(file)\r\n        console.log(err);\r\n      }\r\n    },\r\n    created() {\r\n      this.init();\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n    @import \"~@/CSS/Common.less\";\r\n\r\n    .InformationPanel {\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: flex-start;\r\n        width: 100%;\r\n        margin: 0 auto;\r\n        .setSize(350px, 425px);\r\n    }\r\n\r\n    .AvatarUploader {\r\n        width: 100%;\r\n        margin: 25px auto 0 auto;\r\n        display: flex;\r\n        justify-content: center;\r\n    }\r\n\r\n\r\n</style>\r\n\r\n<style lang=\"less\">\r\n    .avatar-uploader {\r\n        .el-upload {\r\n            border: 1px dashed #828282;\r\n            border-radius: 6px;\r\n            cursor: pointer;\r\n            position: relative;\r\n            overflow: hidden;\r\n        }\r\n\r\n        .el-upload:hover {\r\n            border-color: #000000;\r\n        }\r\n\r\n        .avatar-uploader-icon {\r\n            font-size: 28px;\r\n            color: #8c939d;\r\n            width: 178px;\r\n            height: 178px;\r\n            line-height: 178px;\r\n            text-align: center;\r\n        }\r\n\r\n        .avatar {\r\n            width: 178px;\r\n            height: 178px;\r\n            display: block;\r\n        }\r\n    }\r\n</style>"]}]}